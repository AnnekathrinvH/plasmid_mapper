<!DOCTYPE html>
<head>
<title>Plasmid Mapper</title>
<script language="JavaScript" src="bioseq.js"></script>
<style type="text/css">
<!--
	#container { position: relative; }
	#canvas { border: 1px solid #000; }
	body { font: 12px "Lucida Grande", "Lucida Sans Unicode", Arial, sans-serif; }
	textarea { font: 100% "consolas", "Andale Mono", Monaco, Courier; overflow: auto }
-->
</style>
</head>
<body>
<script type="text/javascript">
function do_align()
{
	var time_start = new Date().getTime();

	var target = document.getElementById('target').value.replace(/[\s\n]+/g, '');
	var query  = document.getElementById('query').value .replace(/[\s\n]+/g, '');
	var ms   = parseInt(document.getElementById('match').value);
	var mms  = parseInt(document.getElementById('mismatch').value);
	var gapo = parseInt(document.getElementById('gapo').value);
	var gape = parseInt(document.getElementById('gape').value);
	//hardcode locality;
	var is_local = true;
	//var is_local = document.getElementById('is_local').checked;
	console.log(is_local)

	var rst = bsa_align(is_local, target, query, [ms, mms], [gapo, gape]);
	var str = 'score: ' + rst[0] + '\n';
	str += 'start: ' + rst[1] + '\n';
	str += 'cigar: ' + bsa_cigar2str(rst[2]) + '\n\n';
	//str += 'alignment:\n\n';
	// var fmt = bsa_cigar2gaps(target, query, rst[1], rst[2]);
	// console.log(fmt)
	//
	// var linelen = 100, n_lines = 10;
	// for (var l = 0; l < fmt[0].length; l += linelen) {
	// 	str += fmt[0].substr(l, linelen) + '\n';
	// 	str += fmt[1].substr(l, linelen) + '\n\n';
	// 	n_lines += 3;
	// }

	document.getElementById('out').value = str;
	//document.getElementById('out').rows = n_lines;

	var elapse = (new Date().getTime() - time_start) / 1000.0;
	document.getElementById('runtime').innerHTML = "in " + elapse.toFixed(3) + "s";
}
</script>

<p>
Target sequence:<br>
<textarea id="target" rows="10" cols="110">ATAG</textarea>
</p>
<p>
Query sequence:<br>
<textarea id="query" rows="10" cols="110">ATAG</textarea>
</p>
<p>
<input type="button" value="Align" onClick="do_align();"/>
<!--local alignment: <input type="checkbox" id="is_local" checked/> -->
match score: <input size="3" value="1" id="match"/>
mismatch: <input size="3" value="-1" id="mismatch"/>
deletion: <input size="3" value="-1" id="gapo"/>
insertion: <input size="3" value="-1" id="gape"/>
<span id="runtime" style="color: gray;"></span>
</p>
<textarea id="out" rows="3" readOnly style="border: 0" cols="110" wrap="on" style="overflow:hidden"></textarea>

</body>
